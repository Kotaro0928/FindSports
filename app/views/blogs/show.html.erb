<div class="container">
  <div class="row">
    <div class="col-lg-3 text-center">
      <%= render 'users/side-profile' %>

    </div>
    <div class="col-lg-9 show-blog">
      <div class="show-top">
        <h3>ブログ詳細</h3>
        <% if @blog.user == current_user %>
          <%= link_to "ブログを削除する", blog_path, method: :delete, data: { confirm: "【確認】ブログを削除してもよろしいですか？" }, class:'btn btn-danger' %>
        <% end %>
      </div>
      <table class="table">
        <tbody>
          <tr>
            <th>タイトル</th>
            <td><%= @blog.title %></td>
          </tr>
          <tr>
            <th>投稿者</th>
            <td>
              <%= link_to user_path(@blog.user_id), class:'user_name' do %>
                <%= attachment_image_tag @blog.user, :profile_image, size: '30x30', format:'jpg', fallback:'no_image.png', class:'profile_image' %>
                <%= @blog.user.name %></br>
              <% end %>
            </td>
          </tr>
          <tr>
            <th>スポーツ名</th>
            <td><%= @blog.sport %></td>
          </tr>
          <tr>
            <th>本文</th>
            <td><%= @blog.body %></td>
          </tr>
        </tbody>
      </table>

      <div class="like">
        <% if @blog.liked_by?(current_user) %>
          <span>
            <%= link_to blog_blog_likes_path(@blog), method: :delete do %>
              <i class="fas fa-thumbs-up"></i><%= @blog.blog_likes.count %> いいね
            <% end %>
          </span>
        <% else %>
          <span>
            <%= link_to blog_blog_likes_path(@blog), method: :post do %>
              <i class="far fa-thumbs-up"></i><%= @blog.blog_likes.count %> いいね
            <% end %>
          </span>
        <% end %>
        <span>コメント件数：<%= @blog.blog_comments.count %></span>
      </div>

      <div class="new-comment">
        <%= form_with(model:[@blog, @blog_comment], local: true) do |f| %>
          <%= f.text_area :comment, rows:'5',placeholder: "コメントを書く", class: 'form-control' %>
          <%= f.submit "コメントする", class:'btn btn-info' %>
        <% end %>
      </div>
      <table class="table table-borderless table-sm comments">
        <% @blog.blog_comments.order("id DESC").each do |blog_comment| %>
          <tr>
            <td>
              <%= link_to user_path(blog_comment.user_id), class:'user_name' do %>
                <%= attachment_image_tag blog_comment.user, :profile_image, size: '30x30', format:'jpg', fallback:'no_image.png', class:'profile_image' %>
                <%= blog_comment.user.name %>
              <% end %>
            </td>
            <td>
              <%= blog_comment.comment %>
            </td>
            <td>
              <% if blog_comment.user == current_user %>
                <%= link_to "コメント削除", blog_blog_comment_path(blog_comment.blog, blog_comment), method: :delete, class:'btn btn-danger btn-sm' %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </table>
    </div>
  </div>
</div>